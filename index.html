<!-- index.html -->
<!doctype html>
<html lang="zh-Hant">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- ğŸ”— è¶…å‰æ©‹æ¥ï¼šæŠŠ /?r=/login ç«‹å³æ›æˆ /loginï¼Œé¿å…å¡åœ¨ ?r= -->
  <script>
    (function () {
      try {
        var u = new URL(window.location.href);
        var r = u.searchParams.get('r');
        // åƒ…å…è¨±ç«™å…§ã€ä¸”æ’é™¤ /class /searchï¼ˆå®ƒå€‘æ˜¯ MPAï¼‰
        var allow = r && /^\/(?!class(?:\/|$)|search(?:\/|$))[A-Za-z0-9._~/%\-]*$/i.test(r);
        if (allow) {
          window.location.replace(r + (u.hash || ''));
        }
      } catch (e) { /* ignore */ }
    })();
  </script>

  <!-- åŸºæœ¬ SEOï¼štitle / description -->
  <title>Eduviaï½œå­¸ä½ æƒ³å­¸çš„</title>
  <meta name="description" content="æ‚¨æ‰€æœ‰éœ€è¦çš„æŠ€èƒ½çš†æ•´åˆæ–¼ä¸€è™•">

  <!-- ä¾ç’°å¢ƒè®Šæ•¸å‹•æ…‹æ³¨å…¥ canonical / OG / Twitter / JSON-LD -->
  <script type="module">
    // è®€å–ç’°å¢ƒè®Šæ•¸
    const SITE_NAME = import.meta.env.VITE_SITE_NAME || 'Eduvia';
    const SITE_URL = (import.meta.env.VITE_SITE_URL || location.origin).replace(/\/+$/, '/');
    const DESC = import.meta.env.VITE_SITE_DESC || (document.querySelector('meta[name="description"]')?.content || '');
    const OG_IMAGE = import.meta.env.VITE_OG_IMAGE || (location.origin + '/og-home.jpg');
    const TW = import.meta.env.VITE_TWITTER || '';

    // canonical
    const link = document.createElement('link');
    link.rel = 'canonical';
    link.href = SITE_URL;
    document.head.appendChild(link);

    // Open Graph / Twitter
    const metas = [
      ['property', 'og:type', 'website'],
      ['property', 'og:site_name', SITE_NAME],
      ['property', 'og:title', document.title],
      ['property', 'og:description', DESC],
      ['property', 'og:url', SITE_URL],
      ['property', 'og:image', OG_IMAGE],
      ['name', 'twitter:card', 'summary_large_image'],
      ['name', 'twitter:site', TW]
    ];
    for (const [k, n, v] of metas) {
      const m = document.createElement('meta');
      m.setAttribute(k, n);
      m.setAttribute('content', v);
      document.head.appendChild(m);
    }

    // JSON-LDï¼šå®£å‘Šç«™å…§æœå°‹ï¼ˆæ”¾é¦–é å³å¯ï¼‰
    const ld = {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": SITE_NAME,
      "url": SITE_URL,
      "potentialAction": {
        "@type": "SearchAction",
        "target": SITE_URL.replace(/\/$/, '') + "/search/?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    };
    const ldScript = document.createElement('script');
    ldScript.type = 'application/ld+json';
    ldScript.textContent = JSON.stringify(ld);
    document.head.appendChild(ldScript);
  </script>
</head>

<body>
  <div id="app"></div>

  <script type="module">
    // åªæœ‰ã€Œæ ¹è·¯å¾‘ / ã€è¼‰å…¥ Home çš„ MPAï¼Œå…¶é¤˜è·¯å¾‘è¼‰å…¥åŸæœ¬ SPA
    const p = location.pathname.replace(/\/+$/, "") || "/";
    if (p === "/") {
      import("/src/home-main.js");
    } else {
      import("/src/main.js");
    }
  </script>
</body>

</html>